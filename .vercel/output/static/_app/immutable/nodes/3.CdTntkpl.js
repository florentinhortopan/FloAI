import{s as Ee,n as te,d as h,i as z,e as s,O as ee,y as f,f as d,h as g,P as R,k as I,l as u,m as T,v as $e,r as De,b as X,Q as de,j,t as S,R as Se,S as st,I as xt,T as kt,p as Ue,U as yt}from"../chunks/CgT0rgf2.js";import{S as Ie,i as Te,a as be,t as me,g as mt,c as gt,d as Be,m as Re,e as Pe,b as He}from"../chunks/C6B6ZOh-.js";import{e as pe}from"../chunks/CXOmKNHw.js";function nt(o,e,l){const t=o.slice();return t[18]=e[l],t}function ot(o){let e,l,t=o[3]?"Edit":"Add",n,i,r,a,b,v,_="Title",p,c,w,x,m,y="Category",E,D,V,C,k,B="Content",M,H,G,$,N,A="Save",P,J,F="Cancel",K,oe;return{c(){e=u("div"),l=u("h3"),n=S(t),i=S(" Document"),r=T(),a=u("div"),b=u("div"),v=u("label"),v.textContent=_,p=T(),c=u("input"),w=T(),x=u("div"),m=u("label"),m.textContent=y,E=T(),D=u("input"),V=T(),C=u("div"),k=u("label"),k.textContent=B,M=T(),H=u("textarea"),G=T(),$=u("div"),N=u("button"),N.textContent=A,P=T(),J=u("button"),J.textContent=F,this.h()},l(Q){e=d(Q,"DIV",{class:!0});var q=g(e);l=d(q,"H3",{class:!0});var ne=g(l);n=j(ne,t),i=j(ne," Document"),ne.forEach(h),r=I(q),a=d(q,"DIV",{class:!0});var re=g(a);b=d(re,"DIV",{});var le=g(b);v=d(le,"LABEL",{class:!0,"data-svelte-h":!0}),R(v)!=="svelte-hvtfnr"&&(v.textContent=_),p=I(le),c=d(le,"INPUT",{type:!0,class:!0,placeholder:!0}),le.forEach(h),w=I(re),x=d(re,"DIV",{});var O=g(x);m=d(O,"LABEL",{class:!0,"data-svelte-h":!0}),R(m)!=="svelte-4mrh2x"&&(m.textContent=y),E=I(O),D=d(O,"INPUT",{type:!0,class:!0,placeholder:!0}),O.forEach(h),V=I(re),C=d(re,"DIV",{});var ae=g(C);k=d(ae,"LABEL",{class:!0,"data-svelte-h":!0}),R(k)!=="svelte-t8vv4i"&&(k.textContent=B),M=I(ae),H=d(ae,"TEXTAREA",{rows:!0,class:!0,placeholder:!0}),g(H).forEach(h),ae.forEach(h),G=I(re),$=d(re,"DIV",{class:!0});var se=g($);N=d(se,"BUTTON",{class:!0,"data-svelte-h":!0}),R(N)!=="svelte-md7w6m"&&(N.textContent=A),P=I(se),J=d(se,"BUTTON",{class:!0,"data-svelte-h":!0}),R(J)!=="svelte-1tltqxg"&&(J.textContent=F),se.forEach(h),re.forEach(h),q.forEach(h),this.h()},h(){f(l,"class","text-xl font-semibold mb-4"),f(v,"class","block text-sm font-medium mb-2"),f(c,"type","text"),f(c,"class","w-full px-4 py-2 border border-input rounded-lg bg-background"),f(c,"placeholder","Document title"),f(m,"class","block text-sm font-medium mb-2"),f(D,"type","text"),f(D,"class","w-full px-4 py-2 border border-input rounded-lg bg-background"),f(D,"placeholder","e.g., guidelines, about, skills"),f(k,"class","block text-sm font-medium mb-2"),f(H,"rows","10"),f(H,"class","w-full px-4 py-2 border border-input rounded-lg bg-background"),f(H,"placeholder","Document content (this will be used to guide Flo's responses)"),f(N,"class","px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"),f(J,"class","px-4 py-2 border border-input rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors"),f($,"class","flex gap-2"),f(a,"class","space-y-4"),f(e,"class","bg-white dark:bg-slate-800 p-6 rounded-lg shadow")},m(Q,q){z(Q,e,q),s(e,l),s(l,n),s(l,i),s(e,r),s(e,a),s(a,b),s(b,v),s(b,p),s(b,c),de(c,o[4]),s(a,w),s(a,x),s(x,m),s(x,E),s(x,D),de(D,o[6]),s(a,V),s(a,C),s(C,k),s(C,M),s(C,H),de(H,o[5]),s(a,G),s(a,$),s($,N),s($,P),s($,J),K||(oe=[ee(c,"input",o[12]),ee(D,"input",o[13]),ee(H,"input",o[14]),ee(N,"click",o[7]),ee(J,"click",o[10])],K=!0)},p(Q,q){q&8&&t!==(t=Q[3]?"Edit":"Add")&&X(n,t),q&16&&c.value!==Q[4]&&de(c,Q[4]),q&64&&D.value!==Q[6]&&de(D,Q[6]),q&32&&de(H,Q[5])},d(Q){Q&&h(e),K=!1,De(oe)}}}function wt(o){let e,l=pe(o[0]),t=[];for(let i=0;i<l.length;i+=1)t[i]=it(nt(o,l,i));let n=null;return l.length||(n=rt()),{c(){e=u("div");for(let i=0;i<t.length;i+=1)t[i].c();n&&n.c(),this.h()},l(i){e=d(i,"DIV",{class:!0});var r=g(e);for(let a=0;a<t.length;a+=1)t[a].l(r);n&&n.l(r),r.forEach(h),this.h()},h(){f(e,"class","space-y-4")},m(i,r){z(i,e,r);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null);n&&n.m(e,null)},p(i,r){if(r&769){l=pe(i[0]);let a;for(a=0;a<l.length;a+=1){const b=nt(i,l,a);t[a]?t[a].p(b,r):(t[a]=it(b),t[a].c(),t[a].m(e,null))}for(;a<t.length;a+=1)t[a].d(1);t.length=l.length,!l.length&&n?n.p(i,r):l.length?n&&(n.d(1),n=null):(n=rt(),n.c(),n.m(e,null))}},d(i){i&&h(e),Se(t,i),n&&n.d()}}}function Ct(o){let e,l='<div class="text-muted-foreground">Loading documents...</div>';return{c(){e=u("div"),e.innerHTML=l,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-i302mf"&&(e.innerHTML=l),this.h()},h(){f(e,"class","flex items-center justify-center py-12")},m(t,n){z(t,e,n)},p:te,d(t){t&&h(e)}}}function rt(o){let e,l=`No documents yet. Add your first document to guide Flo's responses!
				`;return{c(){e=u("div"),e.textContent=l,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-q1f04g"&&(e.textContent=l),this.h()},h(){f(e,"class","text-center py-12 text-muted-foreground")},m(t,n){z(t,e,n)},p:te,d(t){t&&h(e)}}}function at(o){let e,l,t=o[18].category+"",n;return{c(){e=u("span"),l=S("Category: "),n=S(t),this.h()},l(i){e=d(i,"SPAN",{class:!0});var r=g(e);l=j(r,"Category: "),n=j(r,t),r.forEach(h),this.h()},h(){f(e,"class","text-sm text-muted-foreground")},m(i,r){z(i,e,r),s(e,l),s(e,n)},p(i,r){r&1&&t!==(t=i[18].category+"")&&X(n,t)},d(i){i&&h(e)}}}function it(o){let e,l,t,n,i=o[18].title+"",r,a,b,v,_,p="Edit",c,w,x="Delete",m,y,E=o[18].content.substring(0,200)+"",D,V,C,k,B,M=o[18].category&&at(o);function H(){return o[15](o[18])}function G(){return o[16](o[18])}return{c(){e=u("div"),l=u("div"),t=u("div"),n=u("h3"),r=S(i),a=T(),M&&M.c(),b=T(),v=u("div"),_=u("button"),_.textContent=p,c=T(),w=u("button"),w.textContent=x,m=T(),y=u("p"),D=S(E),V=S("..."),C=T(),this.h()},l($){e=d($,"DIV",{class:!0});var N=g(e);l=d(N,"DIV",{class:!0});var A=g(l);t=d(A,"DIV",{});var P=g(t);n=d(P,"H3",{class:!0});var J=g(n);r=j(J,i),J.forEach(h),a=I(P),M&&M.l(P),P.forEach(h),b=I(A),v=d(A,"DIV",{class:!0});var F=g(v);_=d(F,"BUTTON",{class:!0,"data-svelte-h":!0}),R(_)!=="svelte-1dh8pv7"&&(_.textContent=p),c=I(F),w=d(F,"BUTTON",{class:!0,"data-svelte-h":!0}),R(w)!=="svelte-470dcq"&&(w.textContent=x),F.forEach(h),A.forEach(h),m=I(N),y=d(N,"P",{class:!0});var K=g(y);D=j(K,E),V=j(K,"..."),K.forEach(h),C=I(N),N.forEach(h),this.h()},h(){f(n,"class","text-lg font-semibold"),f(_,"class","px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700"),f(w,"class","px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700"),f(v,"class","flex gap-2"),f(l,"class","flex justify-between items-start mb-2"),f(y,"class","text-muted-foreground mt-2"),f(e,"class","bg-white dark:bg-slate-800 p-6 rounded-lg shadow")},m($,N){z($,e,N),s(e,l),s(l,t),s(t,n),s(n,r),s(t,a),M&&M.m(t,null),s(l,b),s(l,v),s(v,_),s(v,c),s(v,w),s(e,m),s(e,y),s(y,D),s(y,V),s(e,C),k||(B=[ee(_,"click",H),ee(w,"click",G)],k=!0)},p($,N){o=$,N&1&&i!==(i=o[18].title+"")&&X(r,i),o[18].category?M?M.p(o,N):(M=at(o),M.c(),M.m(t,null)):M&&(M.d(1),M=null),N&1&&E!==(E=o[18].content.substring(0,200)+"")&&X(D,E)},d($){$&&h(e),M&&M.d(),k=!1,De(B)}}}function Et(o){let e,l,t,n="Knowledge Base Documents",i,r,a="Add Document",b,v,_,p,c=o[2]&&ot(o);function w(y,E){return y[1]?Ct:wt}let x=w(o),m=x(o);return{c(){e=u("div"),l=u("div"),t=u("h2"),t.textContent=n,i=T(),r=u("button"),r.textContent=a,b=T(),c&&c.c(),v=T(),m.c(),this.h()},l(y){e=d(y,"DIV",{class:!0});var E=g(e);l=d(E,"DIV",{class:!0});var D=g(l);t=d(D,"H2",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-pn3273"&&(t.textContent=n),i=I(D),r=d(D,"BUTTON",{class:!0,"data-svelte-h":!0}),R(r)!=="svelte-d6mewj"&&(r.textContent=a),D.forEach(h),b=I(E),c&&c.l(E),v=I(E),m.l(E),E.forEach(h),this.h()},h(){f(t,"class","text-2xl font-semibold"),f(r,"class","px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"),f(l,"class","flex justify-between items-center"),f(e,"class","space-y-4")},m(y,E){z(y,e,E),s(e,l),s(l,t),s(l,i),s(l,r),s(e,b),c&&c.m(e,null),s(e,v),m.m(e,null),_||(p=ee(r,"click",o[11]),_=!0)},p(y,[E]){y[2]?c?c.p(y,E):(c=ot(y),c.c(),c.m(e,v)):c&&(c.d(1),c=null),x===(x=w(y))&&m?m.p(y,E):(m.d(1),m=x(y),m&&(m.c(),m.m(e,null)))},i:te,o:te,d(y){y&&h(e),c&&c.d(),m.d(),_=!1,p()}}}function Dt(o,e,l){let t=[],n=!0,i=!1,r=null,a="",b="",v="";$e(()=>{_()});async function _(){l(1,n=!0);try{const k=await fetch("/api/admin/knowledge");if(!k.ok)throw new Error("Failed to fetch documents");const B=await k.json();l(0,t=B.documents)}catch(k){console.error("Error loading documents:",k)}finally{l(1,n=!1)}}async function p(){try{const k="/api/admin/knowledge",B=r?"PUT":"POST",M=r?{id:r.id,title:a,content:b,category:v}:{title:a,content:b,category:v};if(!(await fetch(k,{method:B,headers:{"Content-Type":"application/json"},body:JSON.stringify(M)})).ok)throw new Error("Failed to save document");l(4,a=""),l(5,b=""),l(6,v=""),l(3,r=null),l(2,i=!1),await _()}catch(k){console.error("Error saving document:",k),alert("Failed to save document")}}async function c(k){if(confirm("Are you sure you want to delete this document?"))try{if(!(await fetch("/api/admin/knowledge",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:k})})).ok)throw new Error("Failed to delete document");await _()}catch(B){console.error("Error deleting document:",B),alert("Failed to delete document")}}function w(k){l(3,r=k),l(4,a=k.title),l(5,b=k.content),l(6,v=k.category||""),l(2,i=!0)}function x(){l(3,r=null),l(4,a=""),l(5,b=""),l(6,v=""),l(2,i=!1)}const m=()=>{l(2,i=!0),l(3,r=null)};function y(){a=this.value,l(4,a)}function E(){v=this.value,l(6,v)}function D(){b=this.value,l(5,b)}return[t,n,i,r,a,b,v,p,c,w,x,m,y,E,D,k=>w(k),k=>c(k.id)]}class It extends Ie{constructor(e){super(),Te(this,e,Dt,Et,Ee,{})}}function ct(o,e,l){const t=o.slice();return t[10]=e[l],t}function Tt(o){let e,l,t,n='<tr><th class="px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase">Session ID</th> <th class="px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase">Intent</th> <th class="px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase">Messages</th> <th class="px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase">Duration</th> <th class="px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase">Match Rate</th> <th class="px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase">Created</th> <th class="px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase">Actions</th></tr>',i,r,a,b,v=pe(o[2]),_=[];for(let c=0;c<v.length;c+=1)_[c]=dt(ct(o,v,c));let p=o[4]>1&&ut(o);return{c(){e=u("div"),l=u("table"),t=u("thead"),t.innerHTML=n,i=T(),r=u("tbody");for(let c=0;c<_.length;c+=1)_[c].c();a=T(),p&&p.c(),b=Ue(),this.h()},l(c){e=d(c,"DIV",{class:!0});var w=g(e);l=d(w,"TABLE",{class:!0});var x=g(l);t=d(x,"THEAD",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-19jtdun"&&(t.innerHTML=n),i=I(x),r=d(x,"TBODY",{class:!0});var m=g(r);for(let y=0;y<_.length;y+=1)_[y].l(m);m.forEach(h),x.forEach(h),w.forEach(h),a=I(c),p&&p.l(c),b=Ue(),this.h()},h(){f(t,"class","bg-slate-100 dark:bg-slate-700"),f(r,"class","divide-y divide-border"),f(l,"class","w-full"),f(e,"class","bg-white dark:bg-slate-800 rounded-lg shadow overflow-hidden")},m(c,w){z(c,e,w),s(e,l),s(l,t),s(l,i),s(l,r);for(let x=0;x<_.length;x+=1)_[x]&&_[x].m(r,null);z(c,a,w),p&&p.m(c,w),z(c,b,w)},p(c,w){if(w&4){v=pe(c[2]);let x;for(x=0;x<v.length;x+=1){const m=ct(c,v,x);_[x]?_[x].p(m,w):(_[x]=dt(m),_[x].c(),_[x].m(r,null))}for(;x<_.length;x+=1)_[x].d(1);_.length=v.length}c[4]>1?p?p.p(c,w):(p=ut(c),p.c(),p.m(b.parentNode,b)):p&&(p.d(1),p=null)},d(c){c&&(h(e),h(a),h(b)),Se(_,c),p&&p.d(c)}}}function Vt(o){let e,l='<div class="text-muted-foreground">Loading sessions...</div>';return{c(){e=u("div"),e.innerHTML=l,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-1el4xt0"&&(e.innerHTML=l),this.h()},h(){f(e,"class","flex items-center justify-center py-12")},m(t,n){z(t,e,n)},p:te,d(t){t&&h(e)}}}function dt(o){let e,l,t=o[10].sessionId.substring(0,8)+"",n,i,r,a,b=o[10].intent+"",v,_,p,c=o[10].messageCount+"",w,x,m,y=Math.floor(o[10].duration/60)+"",E,D,V=o[10].duration%60+"",C,k,B,M,H=o[10].jobMatchRate?`${Math.round(o[10].jobMatchRate)}%`:"-",G,$,N,A=new Date(o[10].createdAt).toLocaleDateString()+"",P,J,F,K,oe="Export",Q,q,ne;function re(){return o[6](o[10])}return{c(){e=u("tr"),l=u("td"),n=S(t),i=S("..."),r=T(),a=u("td"),v=S(b),_=T(),p=u("td"),w=S(c),x=T(),m=u("td"),E=S(y),D=S("m "),C=S(V),k=S("s"),B=T(),M=u("td"),G=S(H),$=T(),N=u("td"),P=S(A),J=T(),F=u("td"),K=u("button"),K.textContent=oe,Q=T(),this.h()},l(le){e=d(le,"TR",{class:!0});var O=g(e);l=d(O,"TD",{class:!0});var ae=g(l);n=j(ae,t),i=j(ae,"..."),ae.forEach(h),r=I(O),a=d(O,"TD",{class:!0});var se=g(a);v=j(se,b),se.forEach(h),_=I(O),p=d(O,"TD",{class:!0});var ue=g(p);w=j(ue,c),ue.forEach(h),x=I(O),m=d(O,"TD",{class:!0});var he=g(m);E=j(he,y),D=j(he,"m "),C=j(he,V),k=j(he,"s"),he.forEach(h),B=I(O),M=d(O,"TD",{class:!0});var ye=g(M);G=j(ye,H),ye.forEach(h),$=I(O),N=d(O,"TD",{class:!0});var ie=g(N);P=j(ie,A),ie.forEach(h),J=I(O),F=d(O,"TD",{class:!0});var ce=g(F);K=d(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),R(K)!=="svelte-1whwq6o"&&(K.textContent=oe),ce.forEach(h),Q=I(O),O.forEach(h),this.h()},h(){f(l,"class","px-6 py-4 text-sm font-mono"),f(a,"class","px-6 py-4 text-sm capitalize"),f(p,"class","px-6 py-4 text-sm"),f(m,"class","px-6 py-4 text-sm"),f(M,"class","px-6 py-4 text-sm"),f(N,"class","px-6 py-4 text-sm"),f(K,"class","text-blue-600 hover:text-blue-800"),f(F,"class","px-6 py-4 text-sm"),f(e,"class","hover:bg-slate-50 dark:hover:bg-slate-700")},m(le,O){z(le,e,O),s(e,l),s(l,n),s(l,i),s(e,r),s(e,a),s(a,v),s(e,_),s(e,p),s(p,w),s(e,x),s(e,m),s(m,E),s(m,D),s(m,C),s(m,k),s(e,B),s(e,M),s(M,G),s(e,$),s(e,N),s(N,P),s(e,J),s(e,F),s(F,K),s(e,Q),q||(ne=ee(K,"click",re),q=!0)},p(le,O){o=le,O&4&&t!==(t=o[10].sessionId.substring(0,8)+"")&&X(n,t),O&4&&b!==(b=o[10].intent+"")&&X(v,b),O&4&&c!==(c=o[10].messageCount+"")&&X(w,c),O&4&&y!==(y=Math.floor(o[10].duration/60)+"")&&X(E,y),O&4&&V!==(V=o[10].duration%60+"")&&X(C,V),O&4&&H!==(H=o[10].jobMatchRate?`${Math.round(o[10].jobMatchRate)}%`:"-")&&X(G,H),O&4&&A!==(A=new Date(o[10].createdAt).toLocaleDateString()+"")&&X(P,A)},d(le){le&&h(e),q=!1,ne()}}}function ut(o){let e,l,t,n,i,r,a,b,v,_,p,c,w,x,m,y;return{c(){e=u("div"),l=u("button"),t=S("Previous"),i=T(),r=u("span"),a=S("Page "),b=S(o[0]),v=S(" of "),_=S(o[4]),p=T(),c=u("button"),w=S("Next"),this.h()},l(E){e=d(E,"DIV",{class:!0});var D=g(e);l=d(D,"BUTTON",{class:!0});var V=g(l);t=j(V,"Previous"),V.forEach(h),i=I(D),r=d(D,"SPAN",{class:!0});var C=g(r);a=j(C,"Page "),b=j(C,o[0]),v=j(C," of "),_=j(C,o[4]),C.forEach(h),p=I(D),c=d(D,"BUTTON",{class:!0});var k=g(c);w=j(k,"Next"),k.forEach(h),D.forEach(h),this.h()},h(){l.disabled=n=o[0]===1,f(l,"class","px-4 py-2 border rounded-lg disabled:opacity-50"),f(r,"class","px-4 py-2"),c.disabled=x=o[0]===o[4],f(c,"class","px-4 py-2 border rounded-lg disabled:opacity-50"),f(e,"class","flex justify-center gap-2")},m(E,D){z(E,e,D),s(e,l),s(l,t),s(e,i),s(e,r),s(r,a),s(r,b),s(r,v),s(r,_),s(e,p),s(e,c),s(c,w),m||(y=[ee(l,"click",o[7]),ee(c,"click",o[8])],m=!0)},p(E,D){D&1&&n!==(n=E[0]===1)&&(l.disabled=n),D&1&&X(b,E[0]),D&16&&X(_,E[4]),D&17&&x!==(x=E[0]===E[4])&&(c.disabled=x)},d(E){E&&h(e),m=!1,De(y)}}}function Mt(o){let e,l,t,n,i="All Intents",r,a="Hire",b,v="Partner",_,p="Fun",c,w="Newsletter",x,m,y;function E(C,k){return C[3]?Vt:Tt}let D=E(o),V=D(o);return{c(){e=u("div"),l=u("div"),t=u("select"),n=u("option"),n.textContent=i,r=u("option"),r.textContent=a,b=u("option"),b.textContent=v,_=u("option"),_.textContent=p,c=u("option"),c.textContent=w,x=T(),V.c(),this.h()},l(C){e=d(C,"DIV",{class:!0});var k=g(e);l=d(k,"DIV",{class:!0});var B=g(l);t=d(B,"SELECT",{class:!0});var M=g(t);n=d(M,"OPTION",{"data-svelte-h":!0}),R(n)!=="svelte-1cr5n3k"&&(n.textContent=i),r=d(M,"OPTION",{"data-svelte-h":!0}),R(r)!=="svelte-gb3bb2"&&(r.textContent=a),b=d(M,"OPTION",{"data-svelte-h":!0}),R(b)!=="svelte-s0ajq6"&&(b.textContent=v),_=d(M,"OPTION",{"data-svelte-h":!0}),R(_)!=="svelte-73cj94"&&(_.textContent=p),c=d(M,"OPTION",{"data-svelte-h":!0}),R(c)!=="svelte-1lcqmle"&&(c.textContent=w),M.forEach(h),B.forEach(h),x=I(k),V.l(k),k.forEach(h),this.h()},h(){n.__value="",de(n,n.__value),r.__value="hire",de(r,r.__value),b.__value="partner",de(b,b.__value),_.__value="fun",de(_,_.__value),c.__value="newsletter",de(c,c.__value),f(t,"class","px-4 py-2 border border-input rounded-lg bg-background"),o[1]===void 0&&xt(()=>o[5].call(t)),f(l,"class","flex gap-4 items-center"),f(e,"class","space-y-4")},m(C,k){z(C,e,k),s(e,l),s(l,t),s(t,n),s(t,r),s(t,b),s(t,_),s(t,c),st(t,o[1],!0),s(e,x),V.m(e,null),m||(y=ee(t,"change",o[5]),m=!0)},p(C,[k]){k&2&&st(t,C[1]),D===(D=E(C))&&V?V.p(C,k):(V.d(1),V=D(C),V&&(V.c(),V.m(e,null)))},i:te,o:te,d(C){C&&h(e),V.d(),m=!1,y()}}}async function Lt(o){try{const l=await(await fetch(`/api/admin/export?sessionId=${o}&format=csv`)).blob(),t=URL.createObjectURL(l),n=document.createElement("a");n.href=t,n.download=`conversation-${o}.csv`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}catch(e){console.error("Export error:",e),alert("Failed to export session")}}function Nt(o,e,l){let t=[],n=!0,i=1,r=1,a="";$e(()=>{b()});async function b(){l(3,n=!0);try{const w=`/api/admin/sessions?page=${i}&limit=20${a?`&intent=${a}`:""}`,x=await fetch(w);if(!x.ok)throw new Error("Failed to fetch sessions");const m=await x.json();l(2,t=m.sessions),l(4,r=m.pagination.totalPages)}catch(w){console.error("Error loading sessions:",w)}finally{l(3,n=!1)}}function v(){a=kt(this),l(1,a)}const _=w=>Lt(w.sessionId),p=()=>{l(0,i=Math.max(1,i-1))},c=()=>{l(0,i=Math.min(r,i+1))};return o.$$.update=()=>{o.$$.dirty&3&&(i||a)&&b()},[i,a,t,n,r,v,_,p,c]}class At extends Ie{constructor(e){super(),Te(this,e,Nt,Mt,Ee,{})}}function ft(o,e,l){const t=o.slice();return t[4]=e[l],t}function ht(o,e,l){const t=o.slice();return t[7]=e[l][0],t[8]=e[l][1],t}function Ot(o){let e,l,t,n,i="Total Conversations",r,a,b=o[0].overview.totalConversations+"",v,_,p,c,w="Total Messages",x,m,y=o[0].overview.totalMessages+"",E,D,V,C,k="Newsletter Subscribers",B,M,H=o[0].overview.newsletterSubscribers+"",G,$,N,A,P="Avg Job Match Rate",J,F,K=o[0].overview.avgJobMatchRate?`${Math.round(o[0].overview.avgJobMatchRate)}%`:"N/A",oe,Q,q,ne,re="Conversations by Intent",le,O,ae,se,ue,he="Export Data",ye,ie,ce,ze="Export All Conversations (CSV)",Fe,ve,Qe="Export All Conversations (JSON)",qe,_e,ge,Xe="Recent Activity",Je,xe,Ke,Ye,we=pe(Object.entries(o[0].byIntent)),W=[];for(let U=0;U<we.length;U+=1)W[U]=vt(ht(o,we,U));let Ce=pe(o[0].recentActivity),Z=[];for(let U=0;U<Ce.length;U+=1)Z[U]=_t(ft(o,Ce,U));return{c(){e=u("div"),l=u("div"),t=u("div"),n=u("div"),n.textContent=i,r=T(),a=u("div"),v=S(b),_=T(),p=u("div"),c=u("div"),c.textContent=w,x=T(),m=u("div"),E=S(y),D=T(),V=u("div"),C=u("div"),C.textContent=k,B=T(),M=u("div"),G=S(H),$=T(),N=u("div"),A=u("div"),A.textContent=P,J=T(),F=u("div"),oe=S(K),Q=T(),q=u("div"),ne=u("h2"),ne.textContent=re,le=T(),O=u("div");for(let U=0;U<W.length;U+=1)W[U].c();ae=T(),se=u("div"),ue=u("h2"),ue.textContent=he,ye=T(),ie=u("div"),ce=u("button"),ce.textContent=ze,Fe=T(),ve=u("button"),ve.textContent=Qe,qe=T(),_e=u("div"),ge=u("h2"),ge.textContent=Xe,Je=T(),xe=u("div");for(let U=0;U<Z.length;U+=1)Z[U].c();this.h()},l(U){e=d(U,"DIV",{class:!0});var Y=g(e);l=d(Y,"DIV",{class:!0});var L=g(l);t=d(L,"DIV",{class:!0});var fe=g(t);n=d(fe,"DIV",{class:!0,"data-svelte-h":!0}),R(n)!=="svelte-m9opkf"&&(n.textContent=i),r=I(fe),a=d(fe,"DIV",{class:!0});var Ge=g(a);v=j(Ge,b),Ge.forEach(h),fe.forEach(h),_=I(L),p=d(L,"DIV",{class:!0});var Ve=g(p);c=d(Ve,"DIV",{class:!0,"data-svelte-h":!0}),R(c)!=="svelte-k44c65"&&(c.textContent=w),x=I(Ve),m=d(Ve,"DIV",{class:!0});var We=g(m);E=j(We,y),We.forEach(h),Ve.forEach(h),D=I(L),V=d(L,"DIV",{class:!0});var Me=g(V);C=d(Me,"DIV",{class:!0,"data-svelte-h":!0}),R(C)!=="svelte-e8u78r"&&(C.textContent=k),B=I(Me),M=d(Me,"DIV",{class:!0});var Ze=g(M);G=j(Ze,H),Ze.forEach(h),Me.forEach(h),$=I(L),N=d(L,"DIV",{class:!0});var Le=g(N);A=d(Le,"DIV",{class:!0,"data-svelte-h":!0}),R(A)!=="svelte-12wwmob"&&(A.textContent=P),J=I(Le),F=d(Le,"DIV",{class:!0});var et=g(F);oe=j(et,K),et.forEach(h),Le.forEach(h),L.forEach(h),Q=I(Y),q=d(Y,"DIV",{class:!0});var Ne=g(q);ne=d(Ne,"H2",{class:!0,"data-svelte-h":!0}),R(ne)!=="svelte-ggo1uh"&&(ne.textContent=re),le=I(Ne),O=d(Ne,"DIV",{class:!0});var tt=g(O);for(let ke=0;ke<W.length;ke+=1)W[ke].l(tt);tt.forEach(h),Ne.forEach(h),ae=I(Y),se=d(Y,"DIV",{class:!0});var Ae=g(se);ue=d(Ae,"H2",{class:!0,"data-svelte-h":!0}),R(ue)!=="svelte-1v33erq"&&(ue.textContent=he),ye=I(Ae),ie=d(Ae,"DIV",{class:!0});var Oe=g(ie);ce=d(Oe,"BUTTON",{class:!0,"data-svelte-h":!0}),R(ce)!=="svelte-1xd99uv"&&(ce.textContent=ze),Fe=I(Oe),ve=d(Oe,"BUTTON",{class:!0,"data-svelte-h":!0}),R(ve)!=="svelte-199da9t"&&(ve.textContent=Qe),Oe.forEach(h),Ae.forEach(h),qe=I(Y),_e=d(Y,"DIV",{class:!0});var je=g(_e);ge=d(je,"H2",{class:!0,"data-svelte-h":!0}),R(ge)!=="svelte-13w4sl8"&&(ge.textContent=Xe),Je=I(je),xe=d(je,"DIV",{class:!0});var lt=g(xe);for(let ke=0;ke<Z.length;ke+=1)Z[ke].l(lt);lt.forEach(h),je.forEach(h),Y.forEach(h),this.h()},h(){f(n,"class","text-sm text-muted-foreground mb-1"),f(a,"class","text-3xl font-bold"),f(t,"class","bg-white dark:bg-slate-800 p-6 rounded-lg shadow"),f(c,"class","text-sm text-muted-foreground mb-1"),f(m,"class","text-3xl font-bold"),f(p,"class","bg-white dark:bg-slate-800 p-6 rounded-lg shadow"),f(C,"class","text-sm text-muted-foreground mb-1"),f(M,"class","text-3xl font-bold"),f(V,"class","bg-white dark:bg-slate-800 p-6 rounded-lg shadow"),f(A,"class","text-sm text-muted-foreground mb-1"),f(F,"class","text-3xl font-bold"),f(N,"class","bg-white dark:bg-slate-800 p-6 rounded-lg shadow"),f(l,"class","grid grid-cols-1 md:grid-cols-4 gap-4"),f(ne,"class","text-xl font-semibold mb-4"),f(O,"class","grid grid-cols-2 md:grid-cols-4 gap-4"),f(q,"class","bg-white dark:bg-slate-800 p-6 rounded-lg shadow"),f(ue,"class","text-xl font-semibold mb-4"),f(ce,"class","px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"),f(ve,"class","px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"),f(ie,"class","flex gap-4"),f(se,"class","bg-white dark:bg-slate-800 p-6 rounded-lg shadow"),f(ge,"class","text-xl font-semibold mb-4"),f(xe,"class","space-y-2"),f(_e,"class","bg-white dark:bg-slate-800 p-6 rounded-lg shadow"),f(e,"class","space-y-6")},m(U,Y){z(U,e,Y),s(e,l),s(l,t),s(t,n),s(t,r),s(t,a),s(a,v),s(l,_),s(l,p),s(p,c),s(p,x),s(p,m),s(m,E),s(l,D),s(l,V),s(V,C),s(V,B),s(V,M),s(M,G),s(l,$),s(l,N),s(N,A),s(N,J),s(N,F),s(F,oe),s(e,Q),s(e,q),s(q,ne),s(q,le),s(q,O);for(let L=0;L<W.length;L+=1)W[L]&&W[L].m(O,null);s(e,ae),s(e,se),s(se,ue),s(se,ye),s(se,ie),s(ie,ce),s(ie,Fe),s(ie,ve),s(e,qe),s(e,_e),s(_e,ge),s(_e,Je),s(_e,xe);for(let L=0;L<Z.length;L+=1)Z[L]&&Z[L].m(xe,null);Ke||(Ye=[ee(ce,"click",o[2]),ee(ve,"click",o[3])],Ke=!0)},p(U,Y){if(Y&1&&b!==(b=U[0].overview.totalConversations+"")&&X(v,b),Y&1&&y!==(y=U[0].overview.totalMessages+"")&&X(E,y),Y&1&&H!==(H=U[0].overview.newsletterSubscribers+"")&&X(G,H),Y&1&&K!==(K=U[0].overview.avgJobMatchRate?`${Math.round(U[0].overview.avgJobMatchRate)}%`:"N/A")&&X(oe,K),Y&1){we=pe(Object.entries(U[0].byIntent));let L;for(L=0;L<we.length;L+=1){const fe=ht(U,we,L);W[L]?W[L].p(fe,Y):(W[L]=vt(fe),W[L].c(),W[L].m(O,null))}for(;L<W.length;L+=1)W[L].d(1);W.length=we.length}if(Y&1){Ce=pe(U[0].recentActivity);let L;for(L=0;L<Ce.length;L+=1){const fe=ft(U,Ce,L);Z[L]?Z[L].p(fe,Y):(Z[L]=_t(fe),Z[L].c(),Z[L].m(xe,null))}for(;L<Z.length;L+=1)Z[L].d(1);Z.length=Ce.length}},d(U){U&&h(e),Se(W,U),Se(Z,U),Ke=!1,De(Ye)}}}function jt(o){let e,l='<div class="text-muted-foreground">Loading analytics...</div>';return{c(){e=u("div"),e.innerHTML=l,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-13rrab9"&&(e.innerHTML=l),this.h()},h(){f(e,"class","flex items-center justify-center py-12")},m(t,n){z(t,e,n)},p:te,d(t){t&&h(e)}}}function vt(o){let e,l,t=o[8]+"",n,i,r,a=o[7]+"",b,v;return{c(){e=u("div"),l=u("div"),n=S(t),i=T(),r=u("div"),b=S(a),v=T(),this.h()},l(_){e=d(_,"DIV",{class:!0});var p=g(e);l=d(p,"DIV",{class:!0});var c=g(l);n=j(c,t),c.forEach(h),i=I(p),r=d(p,"DIV",{class:!0});var w=g(r);b=j(w,a),w.forEach(h),v=I(p),p.forEach(h),this.h()},h(){f(l,"class","text-2xl font-bold"),f(r,"class","text-sm text-muted-foreground capitalize"),f(e,"class","text-center")},m(_,p){z(_,e,p),s(e,l),s(l,n),s(e,i),s(e,r),s(r,b),s(e,v)},p(_,p){p&1&&t!==(t=_[8]+"")&&X(n,t),p&1&&a!==(a=_[7]+"")&&X(b,a)},d(_){_&&h(e)}}}function _t(o){let e,l,t,n=o[4].intent+"",i,r,a,b=(o[4].firstMessage||"No messages")+"",v,_,p,c=new Date(o[4].createdAt).toLocaleDateString()+"",w,x;return{c(){e=u("div"),l=u("div"),t=u("div"),i=S(n),r=T(),a=u("div"),v=S(b),_=T(),p=u("div"),w=S(c),x=T(),this.h()},l(m){e=d(m,"DIV",{class:!0});var y=g(e);l=d(y,"DIV",{});var E=g(l);t=d(E,"DIV",{class:!0});var D=g(t);i=j(D,n),D.forEach(h),r=I(E),a=d(E,"DIV",{class:!0});var V=g(a);v=j(V,b),V.forEach(h),E.forEach(h),_=I(y),p=d(y,"DIV",{class:!0});var C=g(p);w=j(C,c),C.forEach(h),x=I(y),y.forEach(h),this.h()},h(){f(t,"class","font-medium"),f(a,"class","text-sm text-muted-foreground"),f(p,"class","text-sm text-muted-foreground"),f(e,"class","flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-700 rounded")},m(m,y){z(m,e,y),s(e,l),s(l,t),s(t,i),s(l,r),s(l,a),s(a,v),s(e,_),s(e,p),s(p,w),s(e,x)},p(m,y){y&1&&n!==(n=m[4].intent+"")&&X(i,n),y&1&&b!==(b=(m[4].firstMessage||"No messages")+"")&&X(v,b),y&1&&c!==(c=new Date(m[4].createdAt).toLocaleDateString()+"")&&X(w,c)},d(m){m&&h(e)}}}function St(o){let e;function l(i,r){if(i[1])return jt;if(i[0])return Ot}let t=l(o),n=t&&t(o);return{c(){n&&n.c(),e=Ue()},l(i){n&&n.l(i),e=Ue()},m(i,r){n&&n.m(i,r),z(i,e,r)},p(i,[r]){t===(t=l(i))&&n?n.p(i,r):(n&&n.d(1),n=t&&t(i),n&&(n.c(),n.m(e.parentNode,e)))},i:te,o:te,d(i){i&&h(e),n&&n.d(i)}}}async function pt(o="csv"){try{const l=await(await fetch(`/api/admin/export?format=${o}`)).blob(),t=URL.createObjectURL(l),n=document.createElement("a");n.href=t,n.download=`conversations-${new Date().toISOString()}.${o}`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}catch(e){console.error("Export error:",e),alert("Failed to export conversations")}}function Ut(o,e,l){let t=null,n=!0;return $e(async()=>{try{const a=await fetch("/api/admin/analytics");if(!a.ok)throw new Error("Failed to fetch analytics");l(0,t=await a.json())}catch(a){console.error("Error loading analytics:",a)}finally{l(1,n=!1)}}),[t,n,()=>pt("csv"),()=>pt("json")]}class $t extends Ie{constructor(e){super(),Te(this,e,Ut,St,Ee,{})}}function Bt(o){let e,l;return e=new It({}),{c(){He(e.$$.fragment)},l(t){Pe(e.$$.fragment,t)},m(t,n){Re(e,t,n),l=!0},i(t){l||(me(e.$$.fragment,t),l=!0)},o(t){be(e.$$.fragment,t),l=!1},d(t){Be(e,t)}}}function Rt(o){let e,l;return e=new At({}),{c(){He(e.$$.fragment)},l(t){Pe(e.$$.fragment,t)},m(t,n){Re(e,t,n),l=!0},i(t){l||(me(e.$$.fragment,t),l=!0)},o(t){be(e.$$.fragment,t),l=!1},d(t){Be(e,t)}}}function Pt(o){let e,l;return e=new $t({}),{c(){He(e.$$.fragment)},l(t){Pe(e.$$.fragment,t)},m(t,n){Re(e,t,n),l=!0},i(t){l||(me(e.$$.fragment,t),l=!0)},o(t){be(e.$$.fragment,t),l=!1},d(t){Be(e,t)}}}function Ht(o){let e,l,t='<h1 class="text-4xl font-bold mb-2">Admin Dashboard</h1> <p class="text-muted-foreground">Manage knowledge base, view sessions, and export data</p>',n,i,r,a,b,v,_,p,c,w,x,m,y,E,D,V,C,k,B,M,H;const G=[Pt,Rt,Bt],$=[];function N(A,P){return A[0]==="analytics"?0:A[0]==="sessions"?1:A[0]==="knowledge"?2:-1}return~(C=N(o))&&(k=$[C]=G[C](o)),{c(){e=u("div"),l=u("div"),l.innerHTML=t,n=T(),i=u("div"),r=u("nav"),a=u("button"),b=S("Analytics"),_=T(),p=u("button"),c=S("Sessions"),x=T(),m=u("button"),y=S("Knowledge Base"),D=T(),V=u("div"),k&&k.c(),this.h()},l(A){e=d(A,"DIV",{class:!0});var P=g(e);l=d(P,"DIV",{class:!0,"data-svelte-h":!0}),R(l)!=="svelte-1uh6dzc"&&(l.innerHTML=t),n=I(P),i=d(P,"DIV",{class:!0});var J=g(i);r=d(J,"NAV",{class:!0});var F=g(r);a=d(F,"BUTTON",{class:!0});var K=g(a);b=j(K,"Analytics"),K.forEach(h),_=I(F),p=d(F,"BUTTON",{class:!0});var oe=g(p);c=j(oe,"Sessions"),oe.forEach(h),x=I(F),m=d(F,"BUTTON",{class:!0});var Q=g(m);y=j(Q,"Knowledge Base"),Q.forEach(h),F.forEach(h),J.forEach(h),D=I(P),V=d(P,"DIV",{});var q=g(V);k&&k.l(q),q.forEach(h),P.forEach(h),this.h()},h(){f(l,"class","mb-8"),f(a,"class",v="py-4 px-1 border-b-2 font-medium text-sm "+(o[0]==="analytics"?"border-blue-500 text-blue-600":"border-transparent text-muted-foreground hover:text-foreground")),f(p,"class",w="py-4 px-1 border-b-2 font-medium text-sm "+(o[0]==="sessions"?"border-blue-500 text-blue-600":"border-transparent text-muted-foreground hover:text-foreground")),f(m,"class",E="py-4 px-1 border-b-2 font-medium text-sm "+(o[0]==="knowledge"?"border-blue-500 text-blue-600":"border-transparent text-muted-foreground hover:text-foreground")),f(r,"class","flex space-x-8"),f(i,"class","border-b border-border mb-6"),f(e,"class","container mx-auto px-4 py-8")},m(A,P){z(A,e,P),s(e,l),s(e,n),s(e,i),s(i,r),s(r,a),s(a,b),s(r,_),s(r,p),s(p,c),s(r,x),s(r,m),s(m,y),s(e,D),s(e,V),~C&&$[C].m(V,null),B=!0,M||(H=[ee(a,"click",o[1]),ee(p,"click",o[2]),ee(m,"click",o[3])],M=!0)},p(A,[P]){(!B||P&1&&v!==(v="py-4 px-1 border-b-2 font-medium text-sm "+(A[0]==="analytics"?"border-blue-500 text-blue-600":"border-transparent text-muted-foreground hover:text-foreground")))&&f(a,"class",v),(!B||P&1&&w!==(w="py-4 px-1 border-b-2 font-medium text-sm "+(A[0]==="sessions"?"border-blue-500 text-blue-600":"border-transparent text-muted-foreground hover:text-foreground")))&&f(p,"class",w),(!B||P&1&&E!==(E="py-4 px-1 border-b-2 font-medium text-sm "+(A[0]==="knowledge"?"border-blue-500 text-blue-600":"border-transparent text-muted-foreground hover:text-foreground")))&&f(m,"class",E);let J=C;C=N(A),C!==J&&(k&&(mt(),be($[J],1,1,()=>{$[J]=null}),gt()),~C?(k=$[C],k||(k=$[C]=G[C](A),k.c()),me(k,1),k.m(V,null)):k=null)},i(A){B||(me(k),B=!0)},o(A){be(k),B=!1},d(A){A&&h(e),~C&&$[C].d(),M=!1,De(H)}}}function Ft(o,e,l){let t="analytics";return[t,()=>l(0,t="analytics"),()=>l(0,t="sessions"),()=>l(0,t="knowledge")]}class qt extends Ie{constructor(e){super(),Te(this,e,Ft,Ht,Ee,{})}}function Jt(o){let e,l;return e=new qt({}),{c(){He(e.$$.fragment)},l(t){Pe(e.$$.fragment,t)},m(t,n){Re(e,t,n),l=!0},p:te,i(t){l||(me(e.$$.fragment,t),l=!0)},o(t){be(e.$$.fragment,t),l=!1},d(t){Be(e,t)}}}function Kt(o){let e,l,t;return{c(){e=u("div"),l=u("div"),t=S(bt),this.h()},l(n){e=d(n,"DIV",{class:!0});var i=g(e);l=d(i,"DIV",{class:!0});var r=g(l);t=j(r,bt),r.forEach(h),i.forEach(h),this.h()},h(){f(l,"class","text-red-500"),f(e,"class","flex items-center justify-center min-h-screen")},m(n,i){z(n,e,i),s(e,l),s(l,t)},p:te,i:te,o:te,d(n){n&&h(e)}}}function zt(o){let e,l='<div class="text-muted-foreground">Loading...</div>';return{c(){e=u("div"),e.innerHTML=l,this.h()},l(t){e=d(t,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-10jyfy2"&&(e.innerHTML=l),this.h()},h(){f(e,"class","flex items-center justify-center min-h-screen")},m(t,n){z(t,e,n)},p:te,i:te,o:te,d(t){t&&h(e)}}}function Qt(o){let e,l,t,n,i;const r=[zt,Kt,Jt],a=[];function b(v,_){return v[0]?0:2}return t=b(o),n=a[t]=r[t](o),{c(){e=T(),l=u("div"),n.c(),this.h()},l(v){yt("svelte-1e8sx1n",document.head).forEach(h),e=I(v),l=d(v,"DIV",{class:!0});var p=g(l);n.l(p),p.forEach(h),this.h()},h(){document.title="Admin Dashboard - FloAI",f(l,"class","min-h-screen bg-slate-50 dark:bg-slate-900")},m(v,_){z(v,e,_),z(v,l,_),a[t].m(l,null),i=!0},p(v,[_]){let p=t;t=b(v),t===p?a[t].p(v,_):(mt(),be(a[p],1,1,()=>{a[p]=null}),gt(),n=a[t],n?n.p(v,_):(n=a[t]=r[t](v),n.c()),me(n,1),n.m(l,null))},i(v){i||(me(n),i=!0)},o(v){be(n),i=!1},d(v){v&&(h(e),h(l)),a[t].d()}}}let bt=null;function Xt(o,e,l){let t=!0;return $e(()=>{l(0,t=!1)}),[t]}class Zt extends Ie{constructor(e){super(),Te(this,e,Xt,Qt,Ee,{})}}export{Zt as component};
